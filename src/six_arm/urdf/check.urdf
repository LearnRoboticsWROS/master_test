<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from cobot_camera.urdf.xacro        | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<robot name="custom_robot">
  <!-- Make the robot more fancy :)-->
  <gazebo reference="base_link">
    <material>Gazebo/Blue</material>
  </gazebo>
  <gazebo reference="link1">
    <material>Gazebo/Yellow</material>
  </gazebo>
  <gazebo reference="link2">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="link3">
    <material>Gazebo/Yellow</material>
  </gazebo>
  <gazebo reference="link4">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="link5">
    <material>Gazebo/Yellow</material>
  </gazebo>
  <gazebo reference="link6">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="gripper_connector">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="finger_support">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="finger_right">
    <material>Gazebo/Blue</material>
  </gazebo>
  <gazebo reference="finger_left">
    <material>Gazebo/Blue</material>
  </gazebo>
  <!-- ros control plugin with mimic-->
  <gazebo>
    <plugin filename="libgazebo_grasp_fix.so" name="gazebo_grasp_fix">
      <arm>
        <arm_name>custom_gripper</arm_name>
        <palm_link> link6 </palm_link>
        <gripper_link> finger_right </gripper_link>
        <gripper_link> finger_left </gripper_link>
      </arm>
      <forces_angle_tolerance>100</forces_angle_tolerance>
      <update_rate>4</update_rate>
      <grip_count_threshold>4</grip_count_threshold>
      <max_grip_count>8</max_grip_count>
      <release_tolerance>0.005</release_tolerance>
      <disable_collisions_on_attach>false</disable_collisions_on_attach>
      <contact_topic>__default_topic__</contact_topic>
    </plugin>
  </gazebo>
  <!-- Make the robot more fancy :)-->
  <gazebo reference="base_link">
    <material>Gazebo/Blue</material>
  </gazebo>
  <gazebo reference="link1">
    <material>Gazebo/Yellow</material>
  </gazebo>
  <gazebo reference="link2">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="link3">
    <material>Gazebo/Yellow</material>
  </gazebo>
  <gazebo reference="link4">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="link5">
    <material>Gazebo/Yellow</material>
  </gazebo>
  <gazebo reference="link6">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="gripper_connector">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="finger_support">
    <material>Gazebo/Black</material>
  </gazebo>
  <gazebo reference="finger_right">
    <material>Gazebo/Blue</material>
  </gazebo>
  <gazebo reference="finger_left">
    <material>Gazebo/Blue</material>
  </gazebo>
  <!-- ros control plugin with mimic-->
  <gazebo>
    <plugin filename="libgazebo_grasp_fix.so" name="gazebo_grasp_fix">
      <arm>
        <arm_name>custom_gripper</arm_name>
        <palm_link> link6 </palm_link>
        <gripper_link> finger_right </gripper_link>
        <gripper_link> finger_left </gripper_link>
      </arm>
      <forces_angle_tolerance>100</forces_angle_tolerance>
      <update_rate>4</update_rate>
      <grip_count_threshold>4</grip_count_threshold>
      <max_grip_count>8</max_grip_count>
      <release_tolerance>0.005</release_tolerance>
      <disable_collisions_on_attach>false</disable_collisions_on_attach>
      <contact_topic>__default_topic__</contact_topic>
    </plugin>
  </gazebo>
  <material name="aluminum">
    <color rgba="0.5 0.5 0.5 1"/>
  </material>
  <material name="plastic">
    <color rgba="0.1 0.1 0.1 1"/>
  </material>
  <gazebo reference="camera_bottom_screw_frame">
    <sensor name="wrist_camera" type="depth">
      <!-- openni plugin has the x pointing towards the scene, so rotate to have z -->
      <update_rate>20</update_rate>
      <camera>
        <horizontal_fov>1.047198</horizontal_fov>
        <image>
          <width>640</width>
          <height>480</height>
          <format>R8G8B8</format>
        </image>
        <clip>
          <near>0.05</near>
          <far>10</far>
        </clip>
      </camera>
      <plugin filename="libgazebo_ros_openni_kinect.so" name="camera_plugin">
        <baseline>0.2</baseline>
        <alwaysOn>true</alwaysOn>
        <visualize>true</visualize>
        <!-- Keep this zero, update_rate in the parent <sensor> tag
                will control the frame rate. -->
        <updateRate>0.0</updateRate>
        <cameraName>camera_ir</cameraName>
        <imageTopicName>/camera/color/image_raw</imageTopicName>
        <cameraInfoTopicName>/camera/color/camera_info</cameraInfoTopicName>
        <depthImageTopicName>/camera/depth/image_raw</depthImageTopicName>
        <depthImageCameraInfoTopicName>/camera/depth/camera_info</depthImageCameraInfoTopicName>
        <pointCloudTopicName>/camera/depth/points</pointCloudTopicName>
        <frameName>camera_bottom_screw_frame</frameName>
        <pointCloudCutoff>0.5</pointCloudCutoff>
        <pointCloudCutoffMax>3.0</pointCloudCutoffMax>
        <distortionK1>0</distortionK1>
        <distortionK2>0</distortionK2>
        <distortionK3>0</distortionK3>
        <distortionT1>0</distortionT1>
        <distortionT2>0</distortionT2>
        <CxPrime>0</CxPrime>
        <Cx>0</Cx>
        <Cy>0</Cy>
        <focalLength>0</focalLength>
        <hackBaseline>0</hackBaseline>
      </plugin>
    </sensor>
  </gazebo>
  <link name="world">
    </link>
  <link name="base_link">
    <inertial>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.02"/>
      <mass value="4"/>
      <inertia ixx="0.003033" ixy="0" ixz="0" iyy="0.003033" iyz="0" izz="0.005"/>
    </inertial>
    <visual>
      <geometry>
        <cylinder length="0.04" radius="0.05"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.02"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.04" radius="0.05"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.02"/>
    </collision>
  </link>
  <joint name="fixed" type="fixed">
    <parent link="world"/>
    <child link="base_link"/>
    <origin rpy="0 0 0" xyz="0 0.0 0.8"/>
  </joint>
  <link name="link1">
    <inertial>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.045"/>
      <mass value="3.7"/>
      <inertia ixx="0.003630625" ixy="0" ixz="0" iyy="0.003630625" iyz="0" izz="0.00226625"/>
    </inertial>
    <visual>
      <geometry>
        <cylinder length="0.09" radius="0.035"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.045"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.09" radius="0.035"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.045"/>
    </collision>
  </link>
  <joint name="base_link__link1" type="revolute">
    <parent link="base_link"/>
    <child link="link1"/>
    <axis xyz="0 0 1"/>
    <limit effort="1000" lower="-3.14159" upper="3.14159" velocity="0.5"/>
    <origin rpy="0 0 0" xyz="0 0 0.04"/>
  </joint>
  <link name="link2">
    <inertial>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.2125"/>
      <mass value="8.3"/>
      <inertia ixx="0.499729" ixy="0" ixz="0" iyy="0" iyz="0" izz="0.499729"/>
    </inertial>
    <visual>
      <geometry>
        <cylinder length="0.425" radius="0.035"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.2125"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.425" radius="0.035"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.2125"/>
    </collision>
  </link>
  <joint name="link1__link2" type="revolute">
    <parent link="link1"/>
    <child link="link2"/>
    <axis xyz="0 1 0"/>
    <limit effort="1000.0" lower="-3.14159" upper="3.14159" velocity="0.5"/>
    <origin rpy="0 0 0" xyz="0 0.07 0.055"/>
  </joint>
  <link name="link3">
    <inertial>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.196"/>
      <mass value="2.3"/>
      <inertia ixx="0.117809067" ixy="0" ixz="0" iyy="0" iyz="0" izz="0.117809067"/>
    </inertial>
    <visual>
      <geometry>
        <cylinder length="0.392" radius="0.035"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.196"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.392" radius="0.035"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.196"/>
    </collision>
  </link>
  <joint name="link2__link3" type="revolute">
    <parent link="link2"/>
    <child link="link3"/>
    <axis xyz="0 1 0"/>
    <limit effort="1000" lower="-3.14159" upper="3.14159" velocity="0.5"/>
    <origin rpy="0 0 0" xyz="0 -0.0675 0.39"/>
  </joint>
  <link name="link4">
    <inertial>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.047"/>
      <mass value="1.2"/>
      <inertia ixx="0.0035344" ixy="0" ixz="0" iyy="0" iyz="0" izz="0.0035344"/>
    </inertial>
    <visual>
      <geometry>
        <cylinder length="0.094" radius="0.035"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.047"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.094" radius="0.035"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.047"/>
    </collision>
  </link>
  <joint name="link3__link4" type="revolute">
    <parent link="link3"/>
    <child link="link4"/>
    <axis xyz="0 1 0"/>
    <limit effort="1000" lower="-3.14159" upper="3.14159" velocity="0.5"/>
    <origin rpy="0 0 0" xyz="0 0.0675 0.357"/>
  </joint>
  <link name="link5">
    <inertial>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.009"/>
      <mass value="1.2"/>
      <inertia ixx="0.0027556" ixy="0" ixz="0" iyy="0" iyz="0" izz="0.0027556"/>
    </inertial>
    <visual>
      <geometry>
        <cylinder length="0.083" radius="0.0325"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.009"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.083" radius="0.0325"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.009"/>
    </collision>
  </link>
  <joint name="link4__link5" type="revolute">
    <parent link="link4"/>
    <child link="link5"/>
    <axis xyz="0 1 0"/>
    <limit effort="1000" lower="-3.14159" upper="3.14159" velocity="0.5"/>
    <origin rpy="1.57 0 0" xyz="0 0.0 0.1265"/>
  </joint>
  <link name="link6">
    <inertial>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.01"/>
      <mass value="0.2"/>
      <inertia ixx="5.9479e-05" ixy="0" ixz="0" iyy="5.9479e-05" iyz="0" izz="0.000105625"/>
    </inertial>
    <visual>
      <geometry>
        <cylinder length="0.02" radius="0.0325"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.01"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.02" radius="0.0325"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.01"/>
    </collision>
  </link>
  <joint name="link5__link6" type="revolute">
    <parent link="link5"/>
    <child link="link6"/>
    <axis xyz="0 0 1"/>
    <limit effort="1000" lower="-3.14159" upper="3.14159" velocity="0.5"/>
    <origin rpy="0 0 0" xyz="0 0.0 0.0505"/>
  </joint>
  <!--put end effector tool-->
  <link name="tool0">
    </link>
  <joint name="link6__tool0" type="fixed">
    <parent link="link6"/>
    <child link="tool0"/>
    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.02"/>
  </joint>
  <link name="picking_point">
    </link>
  <joint name="tool0_picking_point" type="fixed">
    <parent link="tool0"/>
    <child link="picking_point"/>
    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.08"/>
  </joint>
  <link name="gripper_connector">
    <inertial>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.015"/>
      <mass value="0.5"/>
      <inertia ixx="0.0002375" ixy="0" ixz="0" iyy="0.0002375" iyz="0" izz="6.666666667e-05"/>
    </inertial>
    <visual>
      <geometry>
        <cylinder length="0.03" radius="0.04"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.015"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.03" radius="0.04"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.0 0.0 0.015"/>
    </collision>
  </link>
  <joint name="{parent}__gripper_connector" type="fixed">
    <parent link="tool0"/>
    <child link="gripper_connector"/>
    <origin rpy="0.0 0.0 0.0" xyz="0 0 0"/>
  </joint>
  <link name="finger_support">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0.005 0.005"/>
      <mass value="0.25"/>
      <inertia ixx="0.0003" ixy="0" ixz="0" iyy="0.0003" iyz="0" izz="0.0003"/>
    </inertial>
    <visual>
      <geometry>
        <box size="0.120 0.01 0.01"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0 0.005 0.005"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.120 0.01 0.01"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0 0.005 0.005"/>
    </collision>
  </link>
  <joint name="finger_support__gripper_connector" type="fixed">
    <parent link="gripper_connector"/>
    <child link="finger_support"/>
    <origin rpy="0.0 0.0 0.0" xyz="0 0 0.03"/>
  </joint>
  <link name="finger_right">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0.04"/>
      <mass value="0.2"/>
      <inertia ixx="0.00042667" ixy="0" ixz="0" iyy="0.00042667" iyz="0" izz="8.3e-06"/>
    </inertial>
    <visual>
      <geometry>
        <box size="0.01 0.01 0.08"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0 0 0.04"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.01 0.01 0.08"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0 0 0.04"/>
    </collision>
  </link>
  <link name="finger_left">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0.04"/>
      <mass value="0.2"/>
      <inertia ixx="0.00042667" ixy="0" ixz="0" iyy="0.00042667" iyz="0" izz="8.3e-06"/>
    </inertial>
    <visual>
      <geometry>
        <box size="0.01 0.01 0.08"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0 0 0.04"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.01 0.01 0.08"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0 0 0.04"/>
    </collision>
  </link>
  <joint name="finger_right_joint" type="prismatic">
    <parent link="finger_support"/>
    <child link="finger_right"/>
    <axis xyz="1 0 0"/>
    <limit effort="400" lower="0" upper="0.044" velocity="0.5"/>
    <origin rpy="0 0 0" xyz="-0.05 0.0 0.011"/>
    <dynamics damping="1" friction="2"/>
  </joint>
  <!-- <xacro:transmission_effort name="trans_finger_right_joint" 
                        joint_name="finger_right_joint" 
                        actuator_name="motor_finger_right_joint" /> -->
  <joint name="finger_left_joint" type="prismatic">
    <parent link="finger_support"/>
    <child link="finger_left"/>
    <axis xyz="1 0 0"/>
    <limit effort="400" lower="-0.044" upper="0" velocity="0.5"/>
    <origin rpy="0 0 0" xyz="0.05 0.0 0.011"/>
    <!-- <dynamics damping="1" friction="2"/> -->
    <dynamics friction="2"/>
    <mimic joint="finger_right_joint" multiplier="-1.0" offset="0"/>
  </joint>
  <!-- <xacro:transmission_effort name="trans_finger_left_joint" 
                        joint_name="finger_left_joint" 
                        actuator_name="motor_finger_left_joint" /> -->
  <gazebo>
    <plugin filename="libroboticsgroup_upatras_gazebo_mimic_joint_plugin.so" name="finger_left_joint_mimic_joint_plugin">
      <joint>finger_right_joint</joint>
      <mimicJoint>finger_left_joint</mimicJoint>
      <multiplier>-1.0</multiplier>
      <offset>0</offset>
      <sensitiveness>0.0</sensitiveness>
      <maxEffort>200</maxEffort>
    </plugin>
  </gazebo>
  <!-- Physical mounting of the camera on the robot -->
  <joint name="realsense_joint" type="fixed">
    <parent link="base_link"/>
    <child link="camera_bottom_screw_frame"/>
    <origin rpy="0 0 0" xyz="0.2 0 0.5"/>
  </joint>
  <!-- <link name="camera_link">
      <visual>
          
          <origin rpy="1.5707963267948966 0 1.5707963267948966" xyz="0.00465 0 0" />
          <geometry>
             
              <mesh filename="/home/fra/master_ws_test/src/realsense-ros/realsense2_description/meshes/d455.stl" scale="0.001 0.001 0.001"/>
          </geometry>
          <material name="aluminum" />
      </visual>
      <collision>
          <origin rpy="0 0 0" xyz="-0.00845 -0.0475 0" />
          <geometry>
              <box size="0.026 0.124 0.029" />
          </geometry>
      </collision>
      <inertial>
         
          <mass value="0.072" />
          <origin xyz="0 0 0" rpy="0 0 0" />
          <inertia ixx="0.003881243" ixy="0.0" ixz="0.0" iyy="0.000498940" iyz="0.0" izz="0.003879257" />
      </inertial>
    </link> -->
  <!-- <joint name="camera_link_joint" type="fixed">
        <origin rpy="0 0 0" xyz="0.011150000000000002 0 0.0145" />
        <parent link="camera_bottom_screw_frame" />
        <child link="camera_link" />
    </joint> -->
  <!-- Istanza della telecamera con posizione relativa -->
  <!-- camera body, with origin at bottom screw mount -->
  <joint name="camera_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0.2 0 0.5"/>
    <parent link="base_link"/>
    <child link="camera_bottom_screw_frame"/>
  </joint>
  <link name="camera_bottom_screw_frame"/>
  <joint name="camera_link_joint" type="fixed">
    <origin rpy="0 0 0" xyz="0.010600000000000002 0.0175 0.0125"/>
    <parent link="camera_bottom_screw_frame"/>
    <child link="camera_link"/>
  </joint>
  <link name="camera_link">
    <visual>
      <!-- the mesh origin is at front plate in between the two infrared camera axes -->
      <origin rpy="1.5707963267948966 0 1.5707963267948966" xyz="0.0043 -0.0175 0"/>
      <geometry>
        <mesh filename="file:///home/fra/master_ws_test/install/realsense2_description/share/realsense2_description/meshes/d435.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 -0.0175 0"/>
      <geometry>
        <box size="0.02505 0.09 0.025"/>
      </geometry>
    </collision>
    <inertial>
      <!-- The following are not reliable values, and should not be used for modeling -->
      <mass value="0.072"/>
      <origin xyz="0 0 0"/>
      <inertia ixx="0.003881243" ixy="0.0" ixz="0.0" iyy="0.000498940" iyz="0.0" izz="0.003879257"/>
    </inertial>
  </link>
  <!-- <xacro:realsense_camera camera_name="realsense" parent_link="base_link"/> -->
  <ros2_control name="GazeboSystem" type="system">
    <hardware>
      <plugin>gazebo_ros2_control/GazeboSystem</plugin>
    </hardware>
    <joint name="base_link__link1">
      <command_interface name="position">
        <param name="min">-6.28</param>
        <param name="max">6.28</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
    </joint>
    <joint name="link1__link2">
      <command_interface name="position">
        <param name="min">-6.28</param>
        <param name="max">6.28</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
    </joint>
    <joint name="link2__link3">
      <command_interface name="position">
        <param name="min">-6.28</param>
        <param name="max">6.28</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
    </joint>
    <joint name="link3__link4">
      <command_interface name="position">
        <param name="min">-6.28</param>
        <param name="max">6.28</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
    </joint>
    <joint name="link4__link5">
      <command_interface name="position">
        <param name="min">-6.28</param>
        <param name="max">6.28</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
    </joint>
    <joint name="link5__link6">
      <command_interface name="position">
        <param name="min">-6.28</param>
        <param name="max">6.28</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
    </joint>
    <joint name="finger_right_joint">
      <command_interface name="position">
        <param name="min">0</param>
        <param name="max">0.05</param>
      </command_interface>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
    </joint>
    <joint name="finger_left_joint">
      <param name="mimic">finger_right_joint</param>
      <param name="multiplier">-1</param>
      <command_interface name="position"/>
      <state_interface name="position">
        <param name="initial_value">0.0</param>
      </state_interface>
      <state_interface name="velocity"/>
    </joint>
  </ros2_control>
  <gazebo>
    <plugin filename="libgazebo_ros2_control.so" name="gazebo_ros2_control">
      <!-- <ros>
                <namespace>/cobot</namespace>
            </ros> -->
      <robot_param>robot_description</robot_param>
      <parameters>/home/fra/master_ws_test/install/six_arm/share/six_arm/config/trajectory_controllers.yaml </parameters>
    </plugin>
  </gazebo>
</robot>
